(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{631:function(t,e,r){"use strict";r.r(e),function(t){r.d(e,"default",(function(){return y}));var a=r(23),n=r(754),o=r(755),i=r(656),s=r(685),c=r(709),d=r(696),l=r.n(d),u=r(37),h=(r(930),r(639)),f=r(728),p=r(756);function v(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return g(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return g(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var a=0;return function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function g(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,a=new Array(e);r<e;r++)a[r]=t[r];return a}function m(t,e){return(m=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var y=function(e){var r,n;function d(t){var r;return(r=e.call(this,t)||this).validationDictionary=Object(i.a)(t),r}n=e,(r=d).prototype=Object.create(n.prototype),r.prototype.constructor=r,m(r,n);var g=d.prototype;return g.formatCategoryTreeForJSTree=function(t){var e=this,r={text:t.data,id:t.metadata.id,state:{selected:t.selected}};return t.state&&(r.state.opened="open"===t.state,r.children=!0),t.children&&(r.children=[],t.children.forEach((function(t){r.children.push(e.formatCategoryTreeForJSTree(t))}))),r},g.showProducts=function(){var e=c.a.replaceParams(window.location.href,{section:"product"});this.$productListingContainer.removeClass("u-hiddenVisually"),this.$facetedSearchContainer.removeClass("u-hiddenVisually"),this.$contentResultsContainer.addClass("u-hiddenVisually"),t("[data-content-results-toggle]").removeClass("navBar-action-color--active"),t("[data-content-results-toggle]").addClass("navBar-action"),t("[data-product-results-toggle]").removeClass("navBar-action"),t("[data-product-results-toggle]").addClass("navBar-action-color--active"),c.a.goToUrl(e)},g.showContent=function(){var e=c.a.replaceParams(window.location.href,{section:"content"});this.$contentResultsContainer.removeClass("u-hiddenVisually"),this.$productListingContainer.addClass("u-hiddenVisually"),this.$facetedSearchContainer.addClass("u-hiddenVisually"),t("[data-product-results-toggle]").removeClass("navBar-action-color--active"),t("[data-product-results-toggle]").addClass("navBar-action"),t("[data-content-results-toggle]").removeClass("navBar-action"),t("[data-content-results-toggle]").addClass("navBar-action-color--active"),c.a.goToUrl(e)},g.onReady=function(){var e=this;Object(s.a)(this.context);var r=t("[data-advanced-search-form]"),n=r.find("[data-search-category-tree]"),o=l.a.parse(window.location.href,!0),i=[];this.$productListingContainer=t("#product-listing-container"),this.$facetedSearchContainer=t("#faceted-search-container"),this.$contentResultsContainer=t("#search-results-content"),this.context&&(this.context.show_bulk_order_mode||this.context.useBulkOrder)&&(this.bulkOrder=Object(p.a)(this.context)),Object(f.a)(),t("#facetedSearch").length>0?this.initFacetedSearch():(this.onSortBySubmit=this.onSortBySubmit.bind(this),a.c.on("sortBy-submitted",this.onSortBySubmit)),Object(u.b)(),t("[data-product-results-toggle]").on("click",(function(t){t.preventDefault(),e.showProducts()})),t("[data-content-results-toggle]").on("click",(function(t){t.preventDefault(),e.showContent()})),0===this.$productListingContainer.find("li.product").length||"content"===o.query.section?this.showContent():this.showProducts();var c=this.initValidation(r).bindValidation(r.find("#search_query_adv"));this.context.categoryTree.forEach((function(t){i.push(e.formatCategoryTreeForJSTree(t))})),this.categoryTreeData=i,this.createCategoryTree(n),r.on("submit",(function(e){var a=n.jstree().get_selected();if(!c.check())return e.preventDefault();r.find('input[name="category[]"]').remove();for(var o,i=v(a);!(o=i()).done;){var s=o.value,d=t("<input>",{type:"hidden",name:"category[]",value:s});r.append(d)}}))},g.destroy=function(){this.facetedSearch?this.facetedSearch.destroy():a.c.off("sortBy-submitted",this.onSortBySubmit)},g.loadTreeNodes=function(e,r){var a=this;t.ajax({url:"/remote/v1/category-tree",data:{selectedCategoryId:e.id,prefix:"category"},headers:{"x-xsrf-token":window.BCData&&window.BCData.csrf_token?window.BCData.csrf_token:""}}).done((function(t){var e=[];t.forEach((function(t){e.push(a.formatCategoryTreeForJSTree(t))})),r(e)}))},g.createCategoryTree=function(t){var e=this,r={core:{data:function(t,r){"#"===t.id?r(e.categoryTreeData):e.loadTreeNodes(t,r)},themes:{icons:!0}},checkbox:{three_state:!1},plugins:["checkbox"]};t.jstree(r),t.on("ready.jstree, redraw.jstree",(function(){return t.find(".jstree-node").removeAttr("aria-selected")})),t.on("changed.jstree",(function(t,e){e.event.currentTarget.closest(".jstree-node").removeAttr("aria-selected")}))},g.initFacetedSearch=function(){var e=this,r=this.validationDictionary,a=r.price_min_evaluation,n=r.price_max_evaluation,i=r.price_min_not_entered,s=r.price_max_not_entered,c=r.price_invalid_value,d=t("#product-listing-container"),l=t("#faceted-search-container"),u=t("#search-results-heading"),h=t("#search-results-product-count"),f={template:{productListing:"search/product-listing",sidebar:"search/sidebar",heading:"search/heading",productCount:"search/product-count"},config:{product_results:{limit:this.context.searchProductsPerPage}},showMore:"search/show-more"};this.facetedSearch=new o.a(f,(function(r){d.html(r.productListing),l.html(r.sidebar),u.html(r.heading),h.html(r.productCount),t("body").triggerHandler("compareReset"),e.bulkOrder&&e.bulkOrder.reinit(),t("html, body").animate({scrollTop:0},100)}),{validationErrorMessages:{onMinPriceError:a,onMaxPriceError:n,minPriceNotEntered:i,maxPriceNotEntered:s,onInvalidPrice:c}})},g.initValidation=function(t){return this.$form=t,this.validator=Object(h.a)({submit:t}),this},g.bindValidation=function(t){return this.validator&&this.validator.add({selector:t,validate:"presence",errorMessage:t.data("errorMessage")}),this},g.check=function(){return!!this.validator&&(this.validator.performCheck(),this.validator.areAll("valid"))},d}(n.a)}.call(this,r(3))}}]);
//# sourceMappingURL=theme-bundle.chunk.29.js.map
